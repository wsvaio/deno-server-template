import{d as Z,a4 as w,w as I,a5 as M,x as g,r as Q,c as F,u as W,a6 as X,a7 as ee,a8 as te,J as ae,a9 as le,aa as oe,ab as se,ac as ne,G as $,$ as N,U as r,z as u,ad as ue,f,ae as k,af as ie,ag as re,S as c,H as A,Y as G,Z as P,a0 as h}from"./index.c546ea7c.js";/* empty css                    */function de(s,K=1e3){let v=null;return()=>{clearTimeout(v),v=setTimeout(s,K)}}const fe={flex:"~ wrap gap-x-12px gap-y-6px",items:"center",class:"vtable-top"},me=h("\u53D6\u6D88"),ge=h("\u786E\u5B9A"),ce=h("\u53D6\u6D88"),ve=h("\u786E\u5B9A"),be=Z({__name:"index",props:{action:null,submit:{type:Function,default:()=>async()=>{}},listKey:{default:"items"},currentKey:{default:"page"},pageSizeKey:{default:"pageSize"},totalKey:{default:"count"},totalPageKey:{default:"max_page"},pagination:null,drawer:{default:()=>({})},dialog:{default:()=>({})},form:{default:()=>({})},table:null},setup(s,{expose:K}){const v=w([]),z=w({});I(z,de(()=>D.value(),500));const p=M(e=>s.action({...e,...z}),{pagination:{currentKey:s.currentKey,pageSizeKey:s.pageSizeKey,totalPageKey:s.totalPageKey,totalKey:s.totalKey}}),D=g(p,"refresh"),x=g(p,"data"),d=g(p,"loading"),B=g(p,"pageSize"),L=g(p,"total"),T=g(p,"current"),b=Q(),S=w({}),C=w({});function _(){var e;P(C,{},{del:!0}),P(l,{show:!1,slot:"",...s.drawer}),P(o,{show:!1,slot:"",...s.dialog}),P(S,s.form),(e=b.value)==null||e.clearValidate()}const l=w({show:!1,slot:""}),O=F(()=>R(s.drawer,l)),o=w({show:!1,slot:""}),j=F(()=>R(s.dialog,o));W(()=>{o.slot?o.show=!0:o.show=!1,l.slot?l.show=!0:l.show=!1});function R(e,t){const m={...e,...t};return delete m.show,delete m.slot,m}const U=X(async(e="")=>{var t,m;return l.show&&await((t=b.value)==null?void 0:t.validate()),o.show&&await((m=b.value)==null?void 0:m.validate()),e&&(l.title=o.title=e),s.submit(i).finally(()=>e&&(l.title=o.title=""))},{manual:!0,onSuccess(e){!e||(D.value(),l.show=o.show=!1)}}),E=g(U,"run"),n=g(U,"loading"),i={params:z,checkList:v,drawer:l,dialog:o,form:C,formProps:S,submit:E.value};return K(i),(e,t)=>{const m=ee,q=te,y=ae,H=le,J=oe,Y=se,V=ne;return $(),N(Y,u({ref_key:"ruleFormRef",ref:b,model:C},{...s.form,...S},{disabled:n.value||d.value}),{default:r(()=>[ue("div",fe,[f(e.$slots,"top",u(i,{loading:d.value,submiting:n.value}))]),k(($(),N(m,u({m:"t-15px",data:x.value&&x.value[s.listKey]||[]},{...e.$attrs,...e.$props.table},{onSelectionChange:t[0]||(t[0]=a=>{v.length=0,v.push(...a)})}),{append:r(()=>[f(e.$slots,"bottom",u(i,{loading:d.value,submiting:n.value}))]),default:r(()=>[f(e.$slots,"default",ie(re(i)))]),_:3},16,["data"])),[[V,d.value]]),c(q,u({currentPage:T.value,"onUpdate:currentPage":t[1]||(t[1]=a=>T.value=a),"page-size":B.value,"onUpdate:page-size":t[2]||(t[2]=a=>B.value=a),m:"t-25px",total:L.value,"page-sizes":[10,20,30,40,50,60,70,80,90,100,200,300,400,500,1e3],layout:"total, sizes, prev, pager, next, jumper, ->, slot"},e.$props.pagination),null,16,["currentPage","page-size","total"]),c(H,u({modelValue:l.show,"onUpdate:modelValue":t[5]||(t[5]=a=>l.show=a)},G(O),{"before-close":a=>n.value||a(),onClosed:_}),{footer:r(()=>[f(e.$slots,`${l.slot}-footer`,u(i,{loading:d.value,submiting:n.value}),()=>[c(y,{onClick:t[3]||(t[3]=a=>l.show=!1)},{default:r(()=>[me]),_:1}),c(y,{type:"primary",onClick:t[4]||(t[4]=a=>E.value())},{default:r(()=>[f(e.$slots,`${l.slot}-submit-text`,u(i,{loading:d.value,submiting:n.value}),()=>[ge])]),_:3})])]),default:r(()=>[k(($(),A("div",null,[f(e.$slots,l.slot,u(i,{loading:d.value,submiting:n.value}))])),[[V,n.value]])]),_:3},16,["modelValue","before-close"]),c(J,u({modelValue:o.show,"onUpdate:modelValue":t[8]||(t[8]=a=>o.show=a)},G(j),{"before-close":a=>n.value||a(),onClosed:_}),{footer:r(()=>[f(e.$slots,`${o.slot}-footer`,u(i,{loading:d.value,submiting:n.value}),()=>[c(y,{onClick:t[6]||(t[6]=a=>o.show=!1)},{default:r(()=>[ce]),_:1}),c(y,{type:"primary",onClick:t[7]||(t[7]=a=>E.value())},{default:r(()=>[f(e.$slots,`${o.slot}-submit-text`,u(i,{loading:d.value,submiting:n.value}),()=>[ve])]),_:3})])]),default:r(()=>[k(($(),A("div",null,[f(e.$slots,o.slot,u(i,{loading:d.value,submiting:n.value}))])),[[V,n.value]])]),_:3},16,["modelValue","before-close"])]),_:3},16,["model","disabled"])}}});export{be as _};
